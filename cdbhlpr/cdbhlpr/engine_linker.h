#ifndef __DEFINE_DBGSUIT_DUMP_ENGINE__
#define __DEFINE_DBGSUIT_DUMP_ENGINE__

class engine_linker : public engine::linker
{
private:
	void *debug_client_;
	void *debug_data_space_;
	void *debug_data_space_2_;
	void *debug_advanced_;
	void *debug_system_objects_;
	void *debug_control_3_;
	void *debug_register_;
	void *debug_symbol_;

	csh cs_handle_;
	cs_insn *insn_;

public:
	bool __stdcall open(char *path);
	bool __stdcall virtual_query(unsigned long long virtual_address, void *out_memory_info);
	bool __stdcall query_virtual(unsigned long long virtual_address, void *out_memory_info);

	unsigned long long __stdcall get_next_virtual_address(unsigned long long);
	unsigned long __stdcall read_virtual_memory(unsigned long long virtual_address, unsigned char *out_memory, unsigned long read_size);
	bool __stdcall get_thread_context(cpu_context_type *context);

	void * __stdcall disasm(unsigned long long address, const unsigned char *table);
	void * __stdcall get_disasm_handle();

	unsigned long long __stdcall get_peb_address();
	unsigned long long __stdcall get_teb_address();

	bool disasm(unsigned long long offset, char *buffer, unsigned long size_of_buffer, unsigned long *size_of_disasm, unsigned long long *next);

	bool get_symbol_name(unsigned long long offset, char *buffer, unsigned long size_of_buffer, unsigned long *size_of_name, unsigned long long *disp);

public:
	engine_linker();
	~engine_linker();
};

#endif